
# Create initial image
func "SyntheticImages/create_torus_gui.amil"

CT_dimx = 100
CT_dimy = 100
CT_dimz = 100
CT_bg = 0
CT_fg = 100
CT_R = 20
CT_r = 4
CT_image_name = "ls_input"
CT_Create

# Run the level set
func "Segmentation/LevelSetsGui1.amil"
LS_input_name  = "ls_input"
LS_load_input()

LS_init_mode = 1
# Create initial sphere
ls_init = ls_input*0-4
AddBrightSphere_mm(&ls_init, CT_dimx/2+CT_R, CT_dimy/2,CT_dimz/2, CT_r-2,-1,1)
LS_initial_name  = "ls_init"
LS_load_initial()

LS_Imean = max(ls_input)
LS_Isd = (max(ls_input)-min(ls_input))/2
LS_T = 150
LS_win.update

LS_ReRun

# save result and compare with pre-computed one
#LS_inls.save "test_levelsets_result.ami.gz"
res = Image "test_levelsets_result.ami.gz"
diff = LS_inls-res
print "Root Mean Square Diff = "
printn sqrt(mean(diff*diff))

#quit
